Прошивки за замовчуванням
=========================

Тут знаходяться прошивки для ```Nanit``` які йдуть по замовчуванню.
Якщо, в процесі вивчення програмування, ви не змогли самостійно написати алгоритми поведінки, які реалізовано нами і вам хочеться погратися з режимами які для вас написали творці та автори, `Nanit` ви можете відновити їх за допомомогю функцій IDE Arduino, або скориставшись спеціальною утилітою

- [Дискавері](./nanite_v3.1.ino.hex)
- [Розумний будинок](./ud_v3.1.ino.hex)

Arduino IDE
-----------

#### Arduino 1.8

        В процесі розробки

#### Arduino (new)

        В процесі 

Без IDE
-------

```avrdude```

```bash
# Інструкція в процесі розробки
```

Очищення EEPROM
===============

Увага очищення пам'яті стирає всі початкові налаштування.
Ми не несемо відповідальності за працездатність деяких режимів `Nanit Дискавері`, також можуть бути застосовані обмеження по гарантійному обслуговуванні `Nanit` `Дискавері` та `Розумний будинок`.

Інструкція для майстрів із сервісного обслуговування

Підключаємо головний блок до ПК за допомогою кабелю і в терміналі чи в емуляторі командного рядка виконуємо команду

```zsh
avrdude -c wiring -p m2560 -b 152000 -U eeprom:w:CLEAR_EEPROM.hex:i
```
### Пояснення
Запускаємо `avrdude` з використанням вбудованого програматора (`wiring`) для мікроконтроллера __ATmega2560__ на швидкості `152000` бод для запису в EEPROM вмісту файлу [CLEAR_EEPROM.hex](./CLEAR_EEPROM.hex), який містить дані для енергонезалежної пам'яті у форматі  IntelHex `:i`


Запис бутлоадера
================

__УВАГА__ не намагайтеся записати мікропрограму завантажувача через вбудований програматор. Для запису бутлоедера потрібен доступ до шини `ISP` через будь-який сторонній програматор.

![ISP](https://raw.githubusercontent.com/NanitRobot/NanitLib/main/pic/ISP_Nanit.png)

Для запису мікропрограми завантажувача потрібен один з файлів

- [Дискавері з бутлоадером](./nanite_v3.1.with_bootloader.hex)
- [NanitInfo з бутлоадером](./NanitInfo.ino.with_bootloader.hex)


Для запису програми на плату `Nanit` потрібно використовути утиліту `avrdude`.

```zsh
 avrdude -c usbtiny -p m2560 -U efuse:w:0xFD:m  -U hfuse:w:0xD8:m  -U lfuse:w:0xFF:m  -U flash:w:NanitInfo.ino.with_bootloader.hex:i -b 152000
 ```

 В даному прикладі використовується `usbtiny`. Разом з прогрмамуванням бутлоадера втсановлюються необхідні ф'юзбіти


|   Fuse  | Value|
|:-------:|:----:|
| lock    | 0xFF |
| lfuse   | 0xD8 |
| hfuse   | 0xFF |
| efuse   | 0xFD |

Підтримувані програматори
-------------------------

Щоб дізнатися пітримувані програматори вашою утилітою для запису бутлоадера потрібно  ввести команду

```zsh
 avrdude -c what
```